@model AWEElectronics.DTO.Product
@{
    ViewBag.Title = "Edit Product";
    var categories = ViewBag.Categories as List<AWEElectronics.DTO.Category>;
    var suppliers = ViewBag.Suppliers as List<AWEElectronics.DTO.Supplier>;
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-6">
            <h2>Edit Product</h2>
        </div>
        <div class="col-md-6 text-end">
            <a href="@Url.Action("Products", "Admin")" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Products
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            @using (Html.BeginForm("EditProduct", "Admin", FormMethod.Post, new { @class = "needs-validation", novalidate = "novalidate" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(m => m.ProductID)
                @Html.ValidationSummary(true, "", new { @class = "alert alert-danger" })

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">SKU <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(m => m.SKU, new { @class = "form-control", required = "required" })
                            @Html.ValidationMessageFor(m => m.SKU, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Product Name <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(m => m.Name, new { @class = "form-control", required = "required" })
                            @Html.ValidationMessageFor(m => m.Name, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Category <span class="text-danger">*</span></label>
                            @Html.DropDownListFor(m => m.CategoryID, 
                                new SelectList(categories, "CategoryID", "Name", Model.CategoryID), 
                                "-- Select Category --", 
                                new { @class = "form-select", required = "required" })
                            @Html.ValidationMessageFor(m => m.CategoryID, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Supplier</label>
                            @Html.DropDownListFor(m => m.SupplierID, 
                                new SelectList(suppliers, "SupplierID", "CompanyName", Model.SupplierID), 
                                "-- No Supplier --", 
                                new { @class = "form-select" })
                            @Html.ValidationMessageFor(m => m.SupplierID, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label class="form-label">Price <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(m => m.Price, new { @class = "form-control", type = "number", step = "0.01", min = "0", required = "required" })
                            @Html.ValidationMessageFor(m => m.Price, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="mb-3">
                            <label class="form-label">Stock Level <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(m => m.StockLevel, new { @class = "form-control", type = "number", min = "0", required = "required" })
                            @Html.ValidationMessageFor(m => m.StockLevel, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="mb-3">
                            <label class="form-label">Status</label>
                            <div class="form-check form-switch mt-2">
                                @Html.CheckBoxFor(m => m.IsPublished, new { @class = "form-check-input" })
                                <label class="form-check-label">Published</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Specifications (JSON format)</label>
                    @Html.TextAreaFor(m => m.Specifications, new { @class = "form-control", rows = "6" })
                    @Html.ValidationMessageFor(m => m.Specifications, "", new { @class = "text-danger" })
                    <small class="form-text text-muted">
                        Example: {"Processor": "Intel Core i5", "RAM": "8GB", "Storage": "256GB SSD"}
                    </small>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <a href="@Url.Action("Products", "Admin")" class="btn btn-secondary">Cancel</a>
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-save"></i> Update Product
                    </button>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
